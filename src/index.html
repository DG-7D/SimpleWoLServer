<!DOCTYPE html>
<html lang="en">

    <head>
        <title>SimpleWoLServer</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="/style.css">
    </head>

    <body>
        <h1>SimpleWoLServer</h1>
        <table>
            <thead>
                <th></th>
                <th>Machine</th>
                <th>Wake</th>
                <th>Service</th>
            </thead>
            <tbody>
                <!-- generate -->
            </tbody>
        </table>
    </body>

    <script>
        const pingElements = document.getElementsByClassName("ping");

        for (const button of document.getElementsByClassName("wake")) {
            button.addEventListener("click", (event) => {
                wake(event.target.dataset.macAddress);
            })
        }
        setInterval(async () => {
            for (const element of pingElements) {
                const hostname = element.dataset.ping;
                if (hostname) {
                    element.textContent = await ping(hostname) ? "ðŸ’¡" : "ðŸ’¤";
                }
            }
        },
            1000);
        function wake(macAddress) {
            fetch(
                "/wake",
                {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        macAddress: macAddress,
                    }),
                }
            )
        }

        async function ping(hostname) {
            const urlSearchParams = new URLSearchParams({ hostname: hostname });
            const url = `/ping?${urlSearchParams.toString()}`;
            return await fetch(url)
                .then(response => response.json())
                .then(json => { return json.responsed });
        }
    </script>

</html>